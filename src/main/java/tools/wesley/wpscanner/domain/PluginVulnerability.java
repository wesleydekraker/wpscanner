package tools.wesley.wpscanner.domain;

import org.hibernate.annotations.Type;

import javax.persistence.*;

@Entity
public class PluginVulnerability {
    @Id
    @GeneratedValue(strategy= GenerationType.IDENTITY)
    private int id;
    @ManyToOne(fetch = FetchType.LAZY)
    private Plugin plugin;
    @Type(type = "tools.wesley.wpscanner.repositories.VersionStringType")
    @Column(nullable = false)
    private Version firstVersion;
    @Type(type = "tools.wesley.wpscanner.repositories.VersionStringType")
    @Column(nullable = false)
    private Version lastVersion;
    @Column(nullable = false, length = 200)
    private String vulnerabilityType;

    /**
     * Constructor is required for Hibernate.
     */
    protected PluginVulnerability() {
    }

    public PluginVulnerability(Version firstVersion, Version lastVersion, String vulnerabilityType) {
        this.firstVersion = firstVersion;
        this.lastVersion = lastVersion;
        this.vulnerabilityType = vulnerabilityType;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public Plugin getPlugin() {
        return plugin;
    }

    public void setPlugin(Plugin plugin) {
        this.plugin = plugin;
    }

    public Version getFirstVersion() {
        return firstVersion;
    }

    public Version getLastVersion() {
        return lastVersion;
    }

    public String getVulnerabilityType() {
        return vulnerabilityType;
    }
}
